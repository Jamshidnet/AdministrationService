CREATE OR REPLACE FUNCTION person_insert_trigger()
RETURNS TRIGGER AS $$
BEGIN
    IF (NEW.quarter_id IS NOT NULL AND NEW.client_type_id IS NOT NULL) THEN
        INSERT INTO clients (quarter_id, client_type_id, "Id", first_name, last_name, birthdate, phone_number)
        VALUES (NEW.quarter_id, NEW.client_type_id, NEW."Id", NEW.first_name, NEW.last_name, NEW.birthdate, NEW.phone_number);
        RETURN NULL;
    ELSEIF (NEW.username IS NOT NULL AND NEW.password IS NOT NULL) THEN
        INSERT INTO users (id, username, password, first_name, last_name, birthdate, phone_number)
        VALUES (NEW."Id", NEW.username, NEW.password, NEW.first_name, NEW.last_name, NEW.birthdate, NEW.phone_number);
        RETURN NULL;
    ELSE
        RAISE EXCEPTION 'Invalid row for person';
    END IF;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER insert_person_trigger
BEFORE INSERT ON person
FOR EACH ROW
EXECUTE FUNCTION person_insert_trigger();


